# üìä Currency Service

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Python-—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤–∞–ª—é—Ç–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞–º–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –≤–∏–¥–µ CLI-–ø—Ä–æ–≥—Ä–∞–º–º—ã —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞–ø—É—Å–∫–∞ REST API.

## üõ† –°—Ç–µ–∫

- Python 3.8‚Äì3.11  
- FastAPI  
- httpx  
- asyncio  
- argparse  
- pydantic  
- uvicorn  
- pytest  

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîÅ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ RUB, USD, EUR —Å —Å–∞–π—Ç–∞ –¶–ë –†–§
- üîß CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
  - `--rub`, `--usd`, `--eur` ‚Äî –Ω–∞—á–∞–ª—å–Ω—ã–µ –±–∞–ª–∞–Ω—Å—ã
  - `--period` ‚Äî –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤ –º–∏–Ω—É—Ç–∞—Ö
  - `--debug` ‚Äî —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (`1`, `true`, `y`, `yes` –∏ —Ç.–¥.)
  - `--api` ‚Äî –∑–∞–ø—É—Å–∫ REST API –≤–º–µ—Å—Ç–æ CLI
- üåê REST API:
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤
  - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
  - –í—ã–≤–æ–¥ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å—É–º–º
- üì¶ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∫—É—Ä—Å–æ–≤

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/yourname/currency_service.git
cd currency_service
poetry install
```

## üß™ –ü—Ä–∏–º–µ—Ä CLI-–∑–∞–ø—É—Å–∫–∞

```bash
poetry run currency_service --rub 1000 --usd 200 --eur 50 --period 1
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∫—É—Ä—Å—ã –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –∏ –≤—ã–≤–æ–¥–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –∫—É—Ä—Å –∏–ª–∏ –±–∞–ª–∞–Ω—Å—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å.

## üåê –ó–∞–ø—É—Å–∫ API-—Å–µ—Ä–≤–µ—Ä–∞

```bash
poetry run currency_service --rub 1000 --usd 200 --eur 50 --period 1 --api
```

–°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://127.0.0.1:8000`

## üìö –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ –≤–∞–ª—é—Ç–µ

```bash
curl http://127.0.0.1:8000/usd/get
```

### –û–±—â–∏–π –æ—Ç—á—ë—Ç

```bash
curl http://127.0.0.1:8000/amount/get
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–µ –±–∞–ª–∞–Ω—Å—ã

```bash
curl -X POST http://127.0.0.1:8000/amount/set \
     -H "Content-Type: application/json" \
     -d '{"usd": 500, "eur": 100}'
```

### –ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è

```bash
curl -X POST http://127.0.0.1:8000/modify \
     -H "Content-Type: application/json" \
     -d '{"usd": 25, "rub": -300}'
```

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
poetry run pytest --cov=currency_service --cov-report=term-missing
```

–ü–æ–∫—Ä—ã—Ç–∏–µ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç:
- –í—Å–µ REST-–º–∞—Ä—à—Ä—É—Ç—ã
- CLI –∑–∞–ø—É—Å–∫ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
currency_service/
‚îú‚îÄ‚îÄ __main__.py              # –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `python -m currency_service`
‚îú‚îÄ‚îÄ main.py                  # CLI –∏ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ api.py                   # FastAPI –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ config.py                # –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ storage.py               # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ updater.py               # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –∏ –≤—ã–≤–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îî‚îÄ‚îÄ rates/
    ‚îú‚îÄ‚îÄ base.py              # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π API –∫—É—Ä—Å–æ–≤
    ‚îî‚îÄ‚îÄ cbr.py               # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –¶–ë –†–§

tests/
‚îú‚îÄ‚îÄ test_api.py              # FastAPI —Ç–µ—Å—Ç—ã —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏
‚îî‚îÄ‚îÄ test_cli.py              # –ü—Ä–æ–≤–µ—Ä–∫–∞ CLI –∏ `--help`

pyproject.toml               # Poetry + –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
poetry.lock                  # Lock-—Ñ–∞–π–ª Poetry
```

## üß† –ê–≤—Ç–æ—Ä

Artem Vologdin  
Python Backend Developer
